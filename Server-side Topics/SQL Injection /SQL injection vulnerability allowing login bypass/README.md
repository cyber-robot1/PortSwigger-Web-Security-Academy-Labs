# Write-up: SQL injection vulnerability allowing login bypass

![1](https://github.com/user-attachments/assets/78fb1151-fdcb-4161-8d19-4aa4945b19a7)

Lab link: https://portswigger.net/web-security/sql-injection/lab-login-bypass

## Lab Description:
![2](https://github.com/user-attachments/assets/d01247da-3944-4054-a5b2-ebc35f566bd0)

#### Notes:
- We wanna login as administrator user .. but we don't have the password for this user.
- so we have to manipulate the original query executed by the server and avoid checking the password for that user.

## Steps:
here's the login function of that application that we target to test as the following:
![1](https://github.com/user-attachments/assets/2f69d564-5a24-4846-ba8c-86f0e4f635b9)
as we see here, we expect that the original query executed by the server will be looks like something like that: 
### Query:
```sql
SELECT * FROM users WHERE username = '<USER>' AND password = '<PASS>';
```
first we wanna to check if it's vulnerable to SQLi or not, we will put a single-quote to break the query and cause an error and see:
![2](https://github.com/user-attachments/assets/04c515fb-67e8-498a-9ec4-fb91813b26cd)

let's see the result: 

![2](https://github.com/user-attachments/assets/247cba6b-6281-446a-b333-d415e705de75)

we got Internal Server Error .. here the query will look like: 
```sql
SELECT * FROM users WHERE username = ''' AND password = '<anything>';
```
so let's try put two single-quotes:

![2](https://github.com/user-attachments/assets/e0c8d22b-9ef4-4e3a-a792-24eca008b590)

we got Invalid username or password.

![3](https://github.com/user-attachments/assets/b6b679bb-4805-4567-bba3-08c56026a13d)

so query will be like that:
```sql
SELECT * FROM users WHERE username = '"' AND password = '<anything>';
```
here it consider that double-quote is the actually username, so no errors will be happened .. so we have an input vector is vulnerable to Error-based SQLi.

Let's get back to our goal: bypass the login function and login as administrator user without knowing his password. 
So we have to manipulate the query and avoiding it from checking the password, and we can do that by putting a SQL comment to prevent the query from checking the password of the user. 
Let's inject this malicious payload in the Username field: 
#### `administrator' -- -`
![4](https://github.com/user-attachments/assets/7c5ecdf3-7c1a-45cc-83d4-d487045b0806)



the query will be like that:
```sql
SELECT * FROM users WHERE username = 'administrator' -- -' AND password = '<anything>';
```
here the rest of the query will be commented and won't be executed, and the final query will be like that: 
```sql
SELECT * FROM users WHERE username = 'administrator';
```
We managed to manipulate the query and make it doesn't check for the password of the user.

so finally we logged-in as administrator user without knowing his password:
![12](https://github.com/user-attachments/assets/61820d45-454e-4d77-bd7b-8769d0c151d7)

The Lab is done!
![15](https://github.com/user-attachments/assets/877ede51-319d-4b88-8fa2-0b56501fabae)







